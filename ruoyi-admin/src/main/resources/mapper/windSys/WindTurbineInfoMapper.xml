<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.windSys.mapper.WindTurbineInfoMapper">
    
    <resultMap type="WindTurbineInfo" id="WindTurbineInfoResult">
        <result property="wId"    column="w_id"    />
        <result property="turbineCode"    column="turbine_code"    />
        <result property="turbineCodePhoto"    column="turbine_code_photo"    />
        <result property="manufacturer"    column="manufacturer"    />
        <result property="bladeManufacturer"    column="blade_manufacturer"    />
        <result property="bladeModel"    column="blade_model"    />
        <result property="inspectionDate"    column="inspection_date"    />
        <result property="maintenanceUnit"    column="maintenance_unit"    />
        <result property="inspectionStaff"    column="inspection_staff"    />
        <result property="entryStaff"    column="entry_staff"    />
        <result property="company"    column="company"    />
        <result property="windFarm"    column="wind_farm"    />
        <result property="blade1Code"    column="blade1_code"    />
        <result property="blade1PhotoUrl"    column="blade1_photo_url"    />
        <result property="blade2Code"    column="blade2_code"    />
        <result property="blade2PhotoUrl"    column="blade2_photo_url"    />
        <result property="blade3Code"    column="blade3_code"    />
        <result property="blade3PhotoUrl"    column="blade3_photo_url"    />
        <result property="wReserve1"    column="w_reserve1"    />
        <result property="wReserve2"    column="w_reserve2"    />
        <result property="wReserve3"    column="w_reserve3"    />
        <result property="wReserve4"    column="w_reserve4"    />
        <result property="wReserve5"    column="w_reserve5"    />
        <result property="wReserve6"    column="w_reserve6"    />
        <result property="wReserve7"    column="w_reserve7"    />
    </resultMap>

    <resultMap id="WindTurbineInfoBladePartResult" type="WindTurbineInfo" extends="WindTurbineInfoResult">
        <collection property="bladePartList" ofType="BladePart" column="w_id" select="selectBladePartList" />
    </resultMap>

    <resultMap type="BladePart" id="BladePartResult">
        <result property="bpId"    column="bp_id"    />
        <result property="bladePartCode"    column="blade_part_code"    />
        <result property="turbineCode"    column="turbine_code"    />
        <result property="bladeCode"    column="blade_code"    />
        <result property="bladePartName"    column="blade_part_name"    />
        <result property="bladePartPhotoUrl"    column="blade_part_photo_url"    />
        <result property="bladePartInspectionResult"    column="blade_part_inspection_result"    />
        <result property="constructionArea"    column="construction_area"    />
        <result property="constructionContent"    column="construction_content"    />
        <result property="bladeInsideOutside"    column="blade_inside_outside"    />
        <result property="uploadTime"    column="upload_time"    />
        <result property="bpReserve1"    column="bp_reserve1"    />
        <result property="bpReserve2"    column="bp_reserve2"    />
        <result property="bpReserve3"    column="bp_reserve3"    />
        <result property="bpReserve4"    column="bp_reserve4"    />
    </resultMap>

    <sql id="selectWindTurbineInfoVo">
        select w_id, turbine_code, turbine_code_photo, manufacturer, blade_manufacturer, blade_model, inspection_date, maintenance_unit, inspection_staff, entry_staff, company, wind_farm, blade1_code, blade1_photo_url, blade2_code, blade2_photo_url, blade3_code, blade3_photo_url, w_reserve1, w_reserve2, w_reserve3, w_reserve4, w_reserve5, w_reserve6, w_reserve7 from wind_turbine_info
    </sql>

    <select id="selectWindTurbineInfoList" parameterType="WindTurbineInfo" resultMap="WindTurbineInfoResult">
        <include refid="selectWindTurbineInfoVo"/>
        <where>  
            <if test="turbineCode != null  and turbineCode != ''"> and turbine_code = #{turbineCode}</if>
            <if test="manufacturer != null  and manufacturer != ''"> and manufacturer = #{manufacturer}</if>
            <if test="bladeManufacturer != null  and bladeManufacturer != ''"> and blade_manufacturer = #{bladeManufacturer}</if>
            <if test="bladeModel != null  and bladeModel != ''"> and blade_model = #{bladeModel}</if>
            <if test="maintenanceUnit != null  and maintenanceUnit != ''"> and maintenance_unit = #{maintenanceUnit}</if>
            <if test="company != null  and company != ''"> and company = #{company}</if>
            <if test="windFarm != null  and windFarm != ''"> and wind_farm = #{windFarm}</if>
        </where>
    </select>
    
    <select id="selectWindTurbineInfoByWId" parameterType="Long" resultMap="WindTurbineInfoBladePartResult">
        select w_id, turbine_code, turbine_code_photo, manufacturer, blade_manufacturer, blade_model, inspection_date, maintenance_unit, inspection_staff, entry_staff, company, wind_farm, blade1_code, blade1_photo_url, blade2_code, blade2_photo_url, blade3_code, blade3_photo_url, w_reserve1, w_reserve2, w_reserve3, w_reserve4, w_reserve5, w_reserve6, w_reserve7
        from wind_turbine_info
        where w_id = #{wId}
    </select>

    <select id="selectBladePartList" resultMap="BladePartResult">
        select bp_id, blade_part_code, turbine_code, blade_code, blade_part_name, blade_part_photo_url, blade_part_inspection_result, construction_area, construction_content, blade_inside_outside, upload_time, bp_reserve1, bp_reserve2, bp_reserve3, bp_reserve4
        from blade_part
        where turbine_code = #{turbine_code}
    </select>

    <insert id="insertWindTurbineInfo" parameterType="WindTurbineInfo" useGeneratedKeys="true" keyProperty="wId">
        insert into wind_turbine_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="turbineCode != null">turbine_code,</if>
            <if test="turbineCodePhoto != null">turbine_code_photo,</if>
            <if test="manufacturer != null">manufacturer,</if>
            <if test="bladeManufacturer != null">blade_manufacturer,</if>
            <if test="bladeModel != null">blade_model,</if>
            <if test="inspectionDate != null">inspection_date,</if>
            <if test="maintenanceUnit != null">maintenance_unit,</if>
            <if test="inspectionStaff != null">inspection_staff,</if>
            <if test="entryStaff != null">entry_staff,</if>
            <if test="company != null">company,</if>
            <if test="windFarm != null">wind_farm,</if>
            <if test="blade1Code != null">blade1_code,</if>
            <if test="blade1PhotoUrl != null">blade1_photo_url,</if>
            <if test="blade2Code != null">blade2_code,</if>
            <if test="blade2PhotoUrl != null">blade2_photo_url,</if>
            <if test="blade3Code != null">blade3_code,</if>
            <if test="blade3PhotoUrl != null">blade3_photo_url,</if>
            <if test="wReserve1 != null">w_reserve1,</if>
            <if test="wReserve2 != null">w_reserve2,</if>
            <if test="wReserve3 != null">w_reserve3,</if>
            <if test="wReserve4 != null">w_reserve4,</if>
            <if test="wReserve5 != null">w_reserve5,</if>
            <if test="wReserve6 != null">w_reserve6,</if>
            <if test="wReserve7 != null">w_reserve7,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="turbineCode != null">#{turbineCode},</if>
            <if test="turbineCodePhoto != null">#{turbineCodePhoto},</if>
            <if test="manufacturer != null">#{manufacturer},</if>
            <if test="bladeManufacturer != null">#{bladeManufacturer},</if>
            <if test="bladeModel != null">#{bladeModel},</if>
            <if test="inspectionDate != null">#{inspectionDate},</if>
            <if test="maintenanceUnit != null">#{maintenanceUnit},</if>
            <if test="inspectionStaff != null">#{inspectionStaff},</if>
            <if test="entryStaff != null">#{entryStaff},</if>
            <if test="company != null">#{company},</if>
            <if test="windFarm != null">#{windFarm},</if>
            <if test="blade1Code != null">#{blade1Code},</if>
            <if test="blade1PhotoUrl != null">#{blade1PhotoUrl},</if>
            <if test="blade2Code != null">#{blade2Code},</if>
            <if test="blade2PhotoUrl != null">#{blade2PhotoUrl},</if>
            <if test="blade3Code != null">#{blade3Code},</if>
            <if test="blade3PhotoUrl != null">#{blade3PhotoUrl},</if>
            <if test="wReserve1 != null">#{wReserve1},</if>
            <if test="wReserve2 != null">#{wReserve2},</if>
            <if test="wReserve3 != null">#{wReserve3},</if>
            <if test="wReserve4 != null">#{wReserve4},</if>
            <if test="wReserve5 != null">#{wReserve5},</if>
            <if test="wReserve6 != null">#{wReserve6},</if>
            <if test="wReserve7 != null">#{wReserve7},</if>
         </trim>
    </insert>

    <update id="updateWindTurbineInfo" parameterType="WindTurbineInfo">
        update wind_turbine_info
        <trim prefix="SET" suffixOverrides=",">
            <if test="turbineCode != null">turbine_code = #{turbineCode},</if>
            <if test="turbineCodePhoto != null">turbine_code_photo = #{turbineCodePhoto},</if>
            <if test="manufacturer != null">manufacturer = #{manufacturer},</if>
            <if test="bladeManufacturer != null">blade_manufacturer = #{bladeManufacturer},</if>
            <if test="bladeModel != null">blade_model = #{bladeModel},</if>
            <if test="inspectionDate != null">inspection_date = #{inspectionDate},</if>
            <if test="maintenanceUnit != null">maintenance_unit = #{maintenanceUnit},</if>
            <if test="inspectionStaff != null">inspection_staff = #{inspectionStaff},</if>
            <if test="entryStaff != null">entry_staff = #{entryStaff},</if>
            <if test="company != null">company = #{company},</if>
            <if test="windFarm != null">wind_farm = #{windFarm},</if>
            <if test="blade1Code != null">blade1_code = #{blade1Code},</if>
            <if test="blade1PhotoUrl != null">blade1_photo_url = #{blade1PhotoUrl},</if>
            <if test="blade2Code != null">blade2_code = #{blade2Code},</if>
            <if test="blade2PhotoUrl != null">blade2_photo_url = #{blade2PhotoUrl},</if>
            <if test="blade3Code != null">blade3_code = #{blade3Code},</if>
            <if test="blade3PhotoUrl != null">blade3_photo_url = #{blade3PhotoUrl},</if>
            <if test="wReserve1 != null">w_reserve1 = #{wReserve1},</if>
            <if test="wReserve2 != null">w_reserve2 = #{wReserve2},</if>
            <if test="wReserve3 != null">w_reserve3 = #{wReserve3},</if>
            <if test="wReserve4 != null">w_reserve4 = #{wReserve4},</if>
            <if test="wReserve5 != null">w_reserve5 = #{wReserve5},</if>
            <if test="wReserve6 != null">w_reserve6 = #{wReserve6},</if>
            <if test="wReserve7 != null">w_reserve7 = #{wReserve7},</if>
        </trim>
        where w_id = #{wId}
    </update>

    <delete id="deleteWindTurbineInfoByWId" parameterType="Long">
        delete from wind_turbine_info where w_id = #{wId}
    </delete>

    <delete id="deleteWindTurbineInfoByWIds" parameterType="String">
        delete from wind_turbine_info where w_id in 
        <foreach item="wId" collection="array" open="(" separator="," close=")">
            #{wId}
        </foreach>
    </delete>
    
    <delete id="deleteBladePartByTurbineCodes" parameterType="String">
        delete from blade_part where turbine_code in 
        <foreach item="turbineCode" collection="array" open="(" separator="," close=")">
            #{turbineCode}
        </foreach>
    </delete>

    <delete id="deleteBladePartByTurbineCode" parameterType="Long">
        delete from blade_part where turbine_code = #{turbineCode}
    </delete>

    <insert id="batchBladePart">
        insert into blade_part( bp_id, blade_part_code, turbine_code, blade_code, blade_part_name, blade_part_photo_url, blade_part_inspection_result, construction_area, construction_content, blade_inside_outside, upload_time, bp_reserve1, bp_reserve2, bp_reserve3, bp_reserve4) values
        <foreach item="item" index="index" collection="list" separator=",">
            ( #{item.bpId}, #{item.bladePartCode}, #{item.turbineCode}, #{item.bladeCode}, #{item.bladePartName}, #{item.bladePartPhotoUrl}, #{item.bladePartInspectionResult}, #{item.constructionArea}, #{item.constructionContent}, #{item.bladeInsideOutside}, #{item.uploadTime}, #{item.bpReserve1}, #{item.bpReserve2}, #{item.bpReserve3}, #{item.bpReserve4})
        </foreach>
    </insert>
</mapper>