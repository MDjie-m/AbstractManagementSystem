<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.SysProductStandardMapper">
    
    <resultMap type="SysProductStandard" id="SysProductStandardResult">
        <result property="productId"    column="product_id"    />
        <result property="productName"    column="product_name"    />
        <result property="primaryCategory"    column="primary_category"    />
        <result property="primaryCategoryName"    column="primary_category_name"    />
        <result property="secondaryCategory"    column="secondary_category"    />
        <result property="secondaryCategoryName"    column="secondary_category_name"    />
        <result property="tertiaryCategory"    column="tertiary_category"    />
        <result property="tertiaryCategoryName"    column="tertiary_category_name"    />
        <result property="quaternaryCategory"    column="quaternary_category"    />
        <result property="quaternaryCategoryName"    column="quaternary_category_name"    />
        <result property="fifthCategory"    column="fifth_category"    />
        <result property="fifthCategoryName"    column="fifth_category_name"    />
        <result property="cnPrimaryCategory"    column="cn_primary_category"    />
        <result property="cnPrimaryCategoryName"    column="cn_primary_category_name"    />
        <result property="cnSecondaryCategory"    column="cn_secondary_category"    />
        <result property="cnSecondaryCategoryName"    column="cn_secondary_category_name"    />
        <result property="cnTertiaryCategory"    column="cn_tertiary_category"    />
        <result property="cnTertiaryCategoryName"    column="cn_tertiary_category_name"    />
        <result property="cnQuaternaryCategory"    column="cn_quaternary_category"    />
        <result property="cnQuaternaryCategoryName"    column="cn_quaternary_category_name"    />
        <result property="cnFifthCategory"    column="cn_fifth_category"    />
        <result property="cnFifthCategoryName"    column="cn_fifth_category_name"    />
        <result property="domesticImportedType"    column="domestic_imported_type"    />
        <result property="storageMode"    column="storage_mode"    />
        <result property="specifications"    column="specifications"    />
        <result property="tagId"    column="tag_id"    />
        <result property="tagName"    column="tag_name"    />
        <result property="delFlag"    column="del_flag"    />
        <result property="imagePath"    column="image_path"    />
        <result property="videoPath"    column="video_path"    />
        <result property="productModel"    column="product_model"    />
        <result property="status"    column="status"    />
        <result property="remark"    column="remark"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <sql id="selectSysProductStandardVo">
        select product_id as productId, product_name as productName, primary_category AS primaryCategory,
               primary_category_name AS primaryCategoryName,secondary_category AS secondaryCategory,
               secondary_category_name AS secondaryCategoryName,tertiary_category AS tertiaryCategory,
               tertiary_category_name AS tertiaryCategoryName,quaternary_category AS quaternaryCategory,
               quaternary_category_name AS quaternaryCategoryName,fifth_category AS fifthCategory,
               fifth_category_name AS fifthCategoryName,cn_primary_category AS cnPrimaryCategory,
               cn_primary_category_name AS cnPrimaryCategoryName,cn_secondary_category AS cnSecondaryCategory,
               cn_secondary_category_name AS cnSecondaryCategoryName,cn_tertiary_category AS cnTertiaryCategory,
               cn_tertiary_category_name AS cnTertiaryCategoryName,cn_quaternary_category AS cnQuaternaryCategory,
               cn_quaternary_category_name AS cnQuaternaryCategoryName,cn_fifth_category AS cnFifthCategory,
               cn_fifth_category_name AS cnFifthCategoryName, domestic_imported_type AS domesticImportedType,
               storage_mode AS storageMode, specifications as specifications, tag_id AS tagId,tag_name AS tagName,
               del_flag as delFlag,image_path as imagePath, video_path as videoPath, product_model AS productModel,
               status as status, remark as remark, create_time as createTime, update_time as updateTime,
               (select count(distinct sp.supplier_id) from sys_product sp where sp.product_name=product_name
                and sp.specifications = specifications) as total
        from sys_product_standard
    </sql>

    <select id="selectSysProductStandardList" parameterType="SysProductStandardDTO" resultType="com.ruoyi.system.domain.SysProductStandard">
        <include refid="selectSysProductStandardVo"/>
        <where>
            <if test="productName != null  and productName != ''"> and product_name like concat('%', #{productName}, '%')</if>
            <if test="specifications == '抄码'">and specifications = '抄码'</if>
            <if test="specifications == '非抄码'">and specifications != '抄码'</if>
            <if test="cnPrimaryCategorys != null and !cnPrimaryCategorys.isEmpty()">
                AND cn_primary_category IN
                <foreach collection="cnPrimaryCategorys" item="cnPrimary" open="(" close=")" separator=",">
                    #{cnPrimary}
                </foreach>
            </if>
            <if test="cnSecondaryCategorys != null and !cnSecondaryCategorys.isEmpty()">
                AND cn_secondary_category IN
                <foreach collection="cnSecondaryCategorys" item="cnSecondary" open="(" close=")" separator=",">
                    #{cnSecondary}
                </foreach>
            </if>
            <if test="cnTertiaryCategorys != null and !cnTertiaryCategorys.isEmpty()">
                AND cn_tertiary_category IN
                <foreach collection="cnTertiaryCategorys" item="cnTertiary" open="(" close=")" separator=",">
                    #{cnTertiary}
                </foreach>
            </if>
            <if test="cnQuaternaryCategorys != null and !cnQuaternaryCategorys.isEmpty()">
                AND cn_quaternary_category IN
                <foreach collection="cnQuaternaryCategorys" item="cnQuaternary" open="(" close=")" separator=",">
                    #{cnQuaternary}
                </foreach>
            </if>
            <if test="cnFifthCategorys != null and !cnFifthCategorys.isEmpty()">
                AND cn_fifth_category IN
                <foreach collection="cnFifthCategorys" item="cnFifth" open="(" close=")" separator=",">
                    #{cnFifth}
                </foreach>
            </if>
            <if test="domesticImportedType != null "> and domestic_imported_type = #{domesticImportedType}</if>
            <if test="storageMode != null"> and storage_mode = #{storageMode}</if>
            <if test="productModel != null  and productModel != ''"> and product_model likle concat('%',#{productModel},'%') </if>
            <if test="status != null"> and status = #{status}</if>
             and del_flag=0
        </where>
    </select>
    
    <select id="selectSysProductStandardByProductId" parameterType="String" resultMap="SysProductStandardResult">
        <include refid="selectSysProductStandardVo"/>
        where product_id = #{productId} and del_flag=0
    </select>

    <insert id="insertSysProductStandard" parameterType="SysProductStandard">
        insert into sys_product_standard
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="productId != null">product_id,</if>
            <if test="productName != null">product_name,</if>
            <if test="primaryCategory != null">primary_category,</if>
            <if test="primaryCategoryName != null">primary_category_name,</if>
            <if test="secondaryCategory != null">secondary_category,</if>
            <if test="secondaryCategoryName != null">secondary_category_name,</if>
            <if test="tertiaryCategory != null">tertiary_category,</if>
            <if test="tertiaryCategoryName != null">tertiary_category_name,</if>
            <if test="quaternaryCategory != null">quaternary_category,</if>
            <if test="quaternaryCategoryName != null">quaternary_category_name,</if>
            <if test="fifthCategory != null">fifth_category,</if>
            <if test="fifthCategoryName != null">fifth_category_name,</if>
            <if test="cnPrimaryCategory != null">cn_primary_category,</if>
            <if test="cnPrimaryCategoryName != null">cn_primary_category_name,</if>
            <if test="cnSecondaryCategory != null">cn_secondary_category,</if>
            <if test="cnSecondaryCategoryName != null">cn_secondary_category_name,</if>
            <if test="cnTertiaryCategory != null">cn_tertiary_category,</if>
            <if test="cnTertiaryCategoryName != null">cn_tertiary_category_name,</if>
            <if test="cnQuaternaryCategory != null">cn_quaternary_category,</if>
            <if test="cnQuaternaryCategoryName != null">cn_quaternary_category_name,</if>
            <if test="cnFifthCategory != null">cn_fifth_category,</if>
            <if test="cnFifthCategoryName != null">cn_fifth_category_name,</if>
            <if test="domesticImportedType != null">domestic_imported_type,</if>
            <if test="storageMode != null">storage_mode,</if>
            <if test="specifications != null">specifications,</if>
            <if test="tagId != null">tag_id,</if>
            <if test="tagName != null">tag_name,</if>
            <if test="delFlag != null">del_flag,</if>
            <if test="imagePath != null">image_path,</if>
            <if test="videoPath != null">video_path,</if>
            <if test="productModel != null">product_model,</if>
            <if test="status != null">status,</if>
            <if test="remark != null">remark,</if>
            create_time
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="productId != null">#{productId},</if>
            <if test="productName != null">#{productName},</if>
            <if test="primaryCategory != null">#{primaryCategory},</if>
            <if test="primaryCategoryName != null">#{primaryCategoryName},</if>
            <if test="secondaryCategory != null">#{secondaryCategory},</if>
            <if test="secondaryCategoryName != null">#{secondaryCategoryName},</if>
            <if test="tertiaryCategory != null">#{tertiaryCategory},</if>
            <if test="tertiaryCategoryName != null">#{tertiaryCategoryName},</if>
            <if test="quaternaryCategory != null">#{quaternaryCategory},</if>
            <if test="quaternaryCategoryName != null">#{quaternaryCategoryName},</if>
            <if test="fifthCategory != null">#{fifthCategory},</if>
            <if test="fifthCategoryName != null">#{fifthCategoryName},</if>
            <if test="cnPrimaryCategory != null">#{cnPrimaryCategory},</if>
            <if test="cnPrimaryCategoryName != null">#{cnPrimaryCategoryName},</if>
            <if test="cnSecondaryCategory != null">#{cnSecondaryCategory},</if>
            <if test="cnSecondaryCategoryName != null">#{cnSecondaryCategoryName},</if>
            <if test="cnTertiaryCategory != null">#{cnTertiaryCategory},</if>
            <if test="cnTertiaryCategoryName != null">#{cnTertiaryCategoryName},</if>
            <if test="cnQuaternaryCategory != null">#{cnQuaternaryCategory},</if>
            <if test="cnQuaternaryCategoryName != null">#{cnQuaternaryCategoryName},</if>
            <if test="cnFifthCategory != null">#{cnFifthCategory},</if>
            <if test="cnFifthCategoryName != null">#{cnFifthCategoryName},</if>
            <if test="domesticImportedType != null">#{domesticImportedType},</if>
            <if test="storageMode != null">#{storageMode},</if>
            <if test="specifications != null">#{specifications},</if>
            <if test="tagId != null">#{tagId},</if>
            <if test="tagName != null">#{tagName},</if>
            <if test="delFlag != null">#{delFlag},</if>
            <if test="imagePath != null">#{imagePath},</if>
            <if test="videoPath != null">#{videoPath},</if>
            <if test="productModel != null">#{productModel},</if>
            <if test="status != null">#{status},</if>
            <if test="remark != null">#{remark},</if>
            sysdate()
         </trim>
    </insert>

    <update id="updateSysProductStandard" parameterType="SysProductStandard">
        update sys_product_standard
        <trim prefix="SET" suffixOverrides=",">
            <if test="productName != null">product_name = #{productName},</if>
            <if test="primaryCategory != null">primary_category = #{primaryCategory},</if>
            <if test="primaryCategoryName != null">primary_category_name = #{primaryCategoryName},</if>
            <if test="secondaryCategory != null">secondary_category = #{secondaryCategory},</if>
            <if test="secondaryCategoryName != null">secondary_category_name = #{secondaryCategoryName},</if>
            <if test="tertiaryCategory != null">tertiary_category = #{tertiaryCategory},</if>
            <if test="tertiaryCategoryName != null">tertiary_category_name = #{tertiaryCategoryName},</if>
            <if test="quaternaryCategory != null">quaternary_category = #{quaternaryCategory},</if>
            <if test="quaternaryCategoryName != null">quaternary_category_name = #{quaternaryCategoryName},</if>
            <if test="fifthCategory != null">fifth_category = #{fifthCategory},</if>
            <if test="fifthCategoryName != null">fifth_category_name = #{fifthCategoryName},</if>
            <if test="cnPrimaryCategory != null">cn_primary_category = #{cnPrimaryCategory},</if>
            <if test="cnPrimaryCategoryName != null">cn_primary_category_name = #{cnPrimaryCategoryName},</if>
            <if test="cnSecondaryCategory != null">cn_secondary_category = #{cnSecondaryCategory},</if>
            <if test="cnSecondaryCategoryName != null">cn_secondary_category_name = #{cnSecondaryCategoryName},</if>
            <if test="cnTertiaryCategory != null">cn_tertiary_category = #{cnTertiaryCategory},</if>
            <if test="cnTertiaryCategoryName != null">cn_tertiary_category_name = #{cnTertiaryCategoryName},</if>
            <if test="cnQuaternaryCategory != null">cn_quaternary_category = #{cnQuaternaryCategory},</if>
            <if test="cnQuaternaryCategoryName != null">cn_quaternary_category_name = #{cnQuaternaryCategoryName},</if>
            <if test="cnFifthCategory != null">cn_fifth_category = #{cnFifthCategory},</if>
            <if test="cnFifthCategoryName != null">cn_fifth_category_name = #{cnFifthCategoryName},</if>
            <if test="domesticImportedType != null">domestic_imported_type = #{domesticImportedType},</if>
            <if test="storageMode != null">storage_mode = #{storageMode},</if>
            <if test="specifications != null">specifications = #{specifications},</if>
            <if test="tagId != null">tag_id = #{tagId},</if>
            <if test="tagName != null">tag_name = #{tagName},</if>
            <if test="delFlag != null">del_flag = #{delFlag},</if>
            <if test="imagePath != null">image_path = #{imagePath},</if>
            <if test="videoPath != null">video_path = #{videoPath},</if>
            <if test="productModel != null">product_model = #{productModel},</if>
            <if test="status != null">status = #{status},</if>
            <if test="remark != null">remark = #{remark},</if>
            update_time = sysdate()
        </trim>
        where product_id = #{productId}
    </update>

    <update id="deleteSysProductStandardByProductIds" parameterType="String">
        update  sys_product_standard set del_flag=1,update_time = sysdate() where product_id in
        <foreach item="productId" collection="array" open="(" separator="," close=")">
            #{productId}
        </foreach>
    </update>
</mapper>